# ============================================================================
# COPD 数字孪生肺项目 - 依赖库列表 (GPU 服务器版本)
# 安装命令: pip install -r requirements.txt
# 目标环境: GPU 服务器 (CUDA 11.8) / Docker (Ubuntu 22.04)
# 更新日期: 2025-12-10 (Revised based on troubleshoot)
# ============================================================================

# =============================================================================
# 核心科学计算 (关键：已锁定 Numpy 版本以避免与 Scipy/OpenCV 冲突)
# =============================================================================
# 注意：Scipy 1.9.x 尚不支持 Numpy 2.0+，必须限制在 1.25 以下
numpy>=1.21.0,<1.25.0
scipy>=1.7.0
scikit-learn>=1.0.0

# =============================================================================
# 通用图像处理 (服务器/Docker 专用)
# =============================================================================
# 使用 Headless 版本以避免 "libGL.so", "X11" 等 GUI 依赖缺失报错
opencv-python-headless>=4.5.0
Pillow>=9.0.0                 # 图像 I/O
scikit-image>=0.19.0          # SSIM, PSNR 等指标

# =============================================================================
# 医学影像处理
# =============================================================================
nibabel>=4.0.0                # NIfTI 文件读写
pydicom>=2.3.0                # DICOM 文件读写
SimpleITK>=2.2.0              # 医学图像处理

# =============================================================================
# 深度学习框架 (GPU 加速)
# =============================================================================
# 推荐锁定版本以确保与 CUDA 11.8 的稳定性
# 对应关系: Torch 2.0.0 <-> Torchvision 0.15.x
torch==2.0.0
torchvision==0.15.1

# =============================================================================
# 肺部分割模型 (2025-12-24 更新)
# =============================================================================
# LungMask: 肺叶分割（LTRCLobes_R231 融合模型，边界清晰）
lungmask>=0.2.20

# Raidionicsrads: 气管树分割（AGU-Net，3-4级支气管）
raidionicsrads>=1.0.0

# [已弃用] TotalSegmentator - 气管树仅分割主气管，肺叶边界碎片化
# TotalSegmentator>=2.0.0

# =============================================================================
# ANTsPy (图像配准与模板构建)
# =============================================================================
# 注意：如果 pip 安装失败，可尝试: pip install git+https://github.com/ANTsX/ANTsPy.git
antspyx>=0.3.0

# =============================================================================
# 数据处理与工具
# =============================================================================
pandas>=1.4.0
tqdm>=4.64.0                  # 进度条
PyYAML>=6.0                   # 配置文件解析
matplotlib>=3.5.0             # 绘图
colorlog>=6.0.0               # 彩色日志输出

# =============================================================================
# 3D 可视化 (可选，服务器端默认注释)
# =============================================================================
# 注意：如果在 Docker 中开启此项，需要安装 xvfb 并配置虚拟显示
# pyvista>=0.37.0
# vtk>=9.1.0

# =============================================================================
# 开发工具 (可选)
# =============================================================================
# pytest>=7.0.0
# pytest-cov>=3.0.0
# black>=22.0.0
# flake8>=4.0.0